2025-11-21 17:27:49,354 INFO     23 task_executor_07449693ba98_0 log path: /ragflow/logs/task_executor_07449693ba98_0.log, log levels: {'peewee': 'WARNING', 'pdfminer': 'WARNING', 'root': 'INFO'}
2025-11-21 17:27:49,356 INFO     23 
    ____                      __  _
   /  _/___  ____ ____  _____/ /_(_)___  ____     ________  ______   _____  _____
   / // __ \/ __ `/ _ \/ ___/ __/ / __ \/ __ \   / ___/ _ \/ ___/ | / / _ \/ ___/
 _/ // / / / /_/ /  __(__  ) /_/ / /_/ / / / /  (__  )  __/ /   | |/ /  __/ /
/___/_/ /_/\__, /\___/____/\__/_/\____/_/ /_/  /____/\___/_/    |___/\___/_/
          /____/
    
2025-11-21 17:27:49,372 INFO     23 RAGFlow version: v0.22.1
2025-11-21 17:27:49,373 INFO     23 Current configs, from /ragflow/conf/service_conf.yaml:
	ragflow: {'host': '0.0.0.0', 'http_port': 9380}
	admin: {'host': '0.0.0.0', 'http_port': 9381}
	mysql: {'name': 'rag_flow', 'user': 'root', 'password': '********', 'host': 'mysql', 'port': 3306, 'max_connections': 900, 'stale_timeout': 300, 'max_allowed_packet': 1073741824}
	minio: {'user': 'rag_flow', 'password': '********', 'host': 'minio:9000'}
	es: {'hosts': 'http://es01:9200', 'username': 'elastic', 'password': '********'}
	os: {'hosts': 'http://opensearch01:9201', 'username': 'admin', 'password': '********'}
	infinity: {'uri': 'infinity:23817', 'db_name': 'default_db'}
	redis: {'db': 1, 'password': '********', 'host': 'redis:6379'}
	user_default_llm: {'default_models': {'embedding_model': {'api_key': 'xxx', 'base_url': 'http://:80'}}}
2025-11-21 17:27:49,375 WARNING  23 SECURITY WARNING: Using auto-generated SECRET_KEY. Generated key: 00bcdb95ea7ac05c30e3e5091db885d6356da66a3406c7c8283c1d1ad3310399
2025-11-21 17:27:49,376 INFO     23 Use Elasticsearch http://es01:9200 as the doc engine.
2025-11-21 17:27:49,382 INFO     23 GET http://es01:9200/ [status:200 duration:0.005s]
2025-11-21 17:27:49,387 INFO     23 HEAD http://es01:9200/ [status:200 duration:0.003s]
2025-11-21 17:27:49,388 INFO     23 Elasticsearch http://es01:9200 is healthy.
2025-11-21 17:27:49,391 WARNING  23 Load term.freq FAIL!
2025-11-21 17:27:49,398 WARNING  23 Realtime synonym is disabled, since no redis connection.
2025-11-21 17:27:49,404 WARNING  23 Load term.freq FAIL!
2025-11-21 17:27:49,410 WARNING  23 Realtime synonym is disabled, since no redis connection.
2025-11-21 17:27:49,412 INFO     23 can't import package 'torch'
2025-11-21 17:27:49,413 INFO     23 settings.EMBEDDING_CFG: {'model': '', 'factory': '', 'api_key': 'xxx', 'base_url': 'http://:80'}
2025-11-21 17:27:49,413 INFO     23 MAX_CONTENT_LENGTH: 134217728
2025-11-21 17:27:49,414 INFO     23 MAX_FILE_COUNT_PER_USER: 0
2025-11-21 17:27:49,417 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:27:49.416+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2025-11-21 17:28:19,422 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:28:19.421+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2025-11-21 17:28:19,427 INFO     23 task_executor_dfcb4ad2be87_0 expired, removed
2025-11-21 17:28:49,433 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:28:49.432+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2025-11-21 17:29:19,438 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:29:19.437+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2025-11-21 17:29:49,443 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:29:49.442+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2025-11-21 17:30:19,447 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:30:19.446+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2025-11-21 17:30:49,449 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:30:49.448+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2025-11-21 17:31:19,503 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:31:19.502+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2025-11-21 17:31:49,504 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:31:49.504+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2025-11-21 17:32:19,508 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:32:19.507+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 0, "failed": 0, "current": {}}
2025-11-21 17:32:40,610 INFO     23 handle_task begin for task {"id": "65dcc4b6c6c511f0a961e6dbbae0e740", "doc_id": "51767f30c6c511f0a961e6dbbae0e740", "from_page": 0, "to_page": 12, "retry_count": 0, "kb_id": "fb64ac5cc6c411f0a961e6dbbae0e740", "parser_id": "qa", "parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "name": "PO-RM-001-R04 Prosedur Manajemen Risiko.pdf", "type": "pdf", "location": "PO-RM-001-R04 Prosedur Manajemen Risiko.pdf", "size": 353499, "tenant_id": "0c0393e0c6c311f0ab43e60423e9a2b1", "language": "English", "embd_id": "text-embedding-004@Gemini", "pagerank": 0, "kb_parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "img2txt_id": "", "asr_id": "", "llm_id": "gemini-2.5-pro@Gemini", "update_time": 1763721156853, "task_type": ""}
2025-11-21 17:32:41,344 INFO     23 HEAD http://es01:9200/ragflow_0c0393e0c6c311f0ab43e60423e9a2b1 [status:404 duration:0.005s]
2025-11-21 17:32:42,183 INFO     23 PUT http://es01:9200/ragflow_0c0393e0c6c311f0ab43e60423e9a2b1 [status:200 duration:0.834s]
2025-11-21 17:32:42,280 INFO     23 handle_task begin for task {"id": "67977ac6c6c511f0a961e6dbbae0e740", "doc_id": "02403212c6c511f0a961e6dbbae0e740", "from_page": 0, "to_page": 12, "retry_count": 0, "kb_id": "fb64ac5cc6c411f0a961e6dbbae0e740", "parser_id": "qa", "parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "name": "PO-RM-001-R04 Prosedur Manajemen Risiko.pdf", "type": "pdf", "location": "PO-RM-001-R04 Prosedur Manajemen Risiko.pdf", "size": 353499, "tenant_id": "0c0393e0c6c311f0ab43e60423e9a2b1", "language": "English", "embd_id": "text-embedding-004@Gemini", "pagerank": 0, "kb_parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "img2txt_id": "", "asr_id": "", "llm_id": "gemini-2.5-pro@Gemini", "update_time": 1763721159768, "task_type": ""}
2025-11-21 17:32:42,844 INFO     23 HEAD http://es01:9200/ragflow_0c0393e0c6c311f0ab43e60423e9a2b1 [status:200 duration:0.008s]
2025-11-21 17:32:42,969 INFO     23 From minio(0.783968799001741) PO-RM-001-R04 Prosedur Manajemen Risiko.pdf/PO-RM-001-R04 Prosedur Manajemen Risiko.pdf
2025-11-21 17:32:43,371 INFO     23 From minio(0.5253141450011753) PO-RM-001-R04 Prosedur Manajemen Risiko.pdf/PO-RM-001-R04 Prosedur Manajemen Risiko.pdf
2025-11-21 17:32:43,418 INFO     23 set_progress(65dcc4b6c6c511f0a961e6dbbae0e740), progress: 0.1, progress_msg: 17:32:43 Page(1~13): Start to parse.
2025-11-21 17:32:43,420 INFO     23 load_model /ragflow/rag/res/deepdoc/det.onnx reuses cached model
2025-11-21 17:32:43,427 INFO     23 load_model /ragflow/rag/res/deepdoc/rec.onnx reuses cached model
2025-11-21 17:32:43,863 INFO     23 load_model /ragflow/rag/res/deepdoc/layout.onnx uses CPU
2025-11-21 17:32:43,923 INFO     23 load_model /ragflow/rag/res/deepdoc/tsr.onnx uses CPU
2025-11-21 17:32:43,936 INFO     23 No torch found.
2025-11-21 17:32:43,987 INFO     23 set_progress(65dcc4b6c6c511f0a961e6dbbae0e740), progress: None, progress_msg: 17:32:43 Page(1~13): OCR started
2025-11-21 17:32:47,243 INFO     23 __images__ dedupe_chars cost 3.254773294000188s
2025-11-21 17:32:47,258 WARNING  23 Miss outlines
2025-11-21 17:32:47,622 INFO     23 __ocr detecting boxes of a image cost (0.3397229529982724s)
2025-11-21 17:32:47,624 INFO     23 __ocr sorting 19 chars cost 0.0014247830004023854s
2025-11-21 17:32:49,514 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:32:49.512+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 2, "lag": 0, "done": 0, "failed": 0, "current": {"65dcc4b6c6c511f0a961e6dbbae0e740": {"id": "65dcc4b6c6c511f0a961e6dbbae0e740", "doc_id": "51767f30c6c511f0a961e6dbbae0e740", "from_page": 0, "to_page": 12, "retry_count": 0, "kb_id": "fb64ac5cc6c411f0a961e6dbbae0e740", "parser_id": "qa", "parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "name": "PO-RM-001-R04 Prosedur Manajemen Risiko.pdf", "type": "pdf", "location": "PO-RM-001-R04 Prosedur Manajemen Risiko.pdf", "size": 353499, "tenant_id": "0c0393e0c6c311f0ab43e60423e9a2b1", "language": "English", "embd_id": "text-embedding-004@Gemini", "pagerank": 0, "kb_parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "img2txt_id": "", "asr_id": "", "llm_id": "gemini-2.5-pro@Gemini", "update_time": 1763721156853, "task_type": ""}, "67977ac6c6c511f0a961e6dbbae0e740": {"id": "67977ac6c6c511f0a961e6dbbae0e740", "doc_id": "02403212c6c511f0a961e6dbbae0e740", "from_page": 0, "to_page": 12, "retry_count": 0, "kb_id": "fb64ac5cc6c411f0a961e6dbbae0e740", "parser_id": "qa", "parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "name": "PO-RM-001-R04 Prosedur Manajemen Risiko.pdf", "type": "pdf", "location": "PO-RM-001-R04 Prosedur Manajemen Risiko.pdf", "size": 353499, "tenant_id": "0c0393e0c6c311f0ab43e60423e9a2b1", "language": "English", "embd_id": "text-embedding-004@Gemini", "pagerank": 0, "kb_parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "img2txt_id": "", "asr_id": "", "llm_id": "gemini-2.5-pro@Gemini", "update_time": 1763721159768, "task_type": ""}}}
2025-11-21 17:32:50,039 INFO     23 __ocr recognize 12 boxes cost 2.413878082003066s
2025-11-21 17:32:50,423 INFO     23 __ocr detecting boxes of a image cost (0.3768754379998427s)
2025-11-21 17:32:50,431 INFO     23 __ocr sorting 420 chars cost 0.006833719999121968s
2025-11-21 17:32:50,495 INFO     23 __ocr recognize 33 boxes cost 0.06227357199895778s
2025-11-21 17:32:50,961 INFO     23 __ocr detecting boxes of a image cost (0.4582718060009938s)
2025-11-21 17:32:50,971 INFO     23 __ocr sorting 1034 chars cost 0.009203513000102248s
2025-11-21 17:32:51,030 INFO     23 __ocr recognize 33 boxes cost 0.0577654539993091s
2025-11-21 17:32:51,304 INFO     23 __ocr detecting boxes of a image cost (0.2666669019999972s)
2025-11-21 17:32:51,324 INFO     23 __ocr sorting 2470 chars cost 0.018585247998998966s
2025-11-21 17:32:51,373 INFO     23 __ocr recognize 45 boxes cost 0.04782950200024061s
2025-11-21 17:32:51,693 INFO     23 __ocr detecting boxes of a image cost (0.31503068700112635s)
2025-11-21 17:32:51,719 INFO     23 __ocr sorting 2503 chars cost 0.024032326000451576s
2025-11-21 17:32:51,765 INFO     23 __ocr recognize 47 boxes cost 0.04534775700085447s
2025-11-21 17:32:52,172 INFO     23 __ocr detecting boxes of a image cost (0.394414112000959s)
2025-11-21 17:32:52,199 INFO     23 __ocr sorting 1646 chars cost 0.0249708039991674s
2025-11-21 17:32:52,265 INFO     23 __ocr recognize 51 boxes cost 0.06482136300110142s
2025-11-21 17:32:52,323 INFO     23 set_progress(65dcc4b6c6c511f0a961e6dbbae0e740), progress: 0.3, progress_msg: 17:32:52 Page(1~13): Processing...
2025-11-21 17:32:52,644 INFO     23 __ocr detecting boxes of a image cost (0.31630211399897235s)
2025-11-21 17:32:52,663 INFO     23 __ocr sorting 1857 chars cost 0.017689050997432787s
2025-11-21 17:32:52,694 INFO     23 __ocr recognize 47 boxes cost 0.030530452000675723s
2025-11-21 17:32:53,027 INFO     23 __ocr detecting boxes of a image cost (0.3257434020015353s)
2025-11-21 17:32:53,056 INFO     23 __ocr sorting 2338 chars cost 0.027716982000129065s
2025-11-21 17:32:53,100 INFO     23 __ocr recognize 57 boxes cost 0.04340069600220886s
2025-11-21 17:32:53,477 INFO     23 __ocr detecting boxes of a image cost (0.36307791500075837s)
2025-11-21 17:32:53,500 INFO     23 __ocr sorting 2107 chars cost 0.021488061000127345s
2025-11-21 17:32:53,562 INFO     23 __ocr recognize 59 boxes cost 0.0610790620012267s
2025-11-21 17:32:53,994 INFO     23 __ocr detecting boxes of a image cost (0.41963963600210263s)
2025-11-21 17:32:54,024 INFO     23 __ocr sorting 1907 chars cost 0.021901321000768803s
2025-11-21 17:32:54,139 INFO     23 __ocr recognize 48 boxes cost 0.11215287300001364s
2025-11-21 17:32:54,487 INFO     23 __ocr detecting boxes of a image cost (0.34205424600077095s)
2025-11-21 17:32:54,507 INFO     23 __ocr sorting 1957 chars cost 0.01905140999951982s
2025-11-21 17:32:54,576 INFO     23 __ocr recognize 55 boxes cost 0.06717085900163511s
2025-11-21 17:32:54,923 INFO     23 __ocr detecting boxes of a image cost (0.33991064300062135s)
2025-11-21 17:32:54,932 INFO     23 __ocr sorting 803 chars cost 0.008146973999828333s
2025-11-21 17:32:55,107 INFO     23 __ocr recognize 40 boxes cost 0.17397061900192057s
2025-11-21 17:32:55,169 INFO     23 set_progress(65dcc4b6c6c511f0a961e6dbbae0e740), progress: 0.6, progress_msg: 17:32:55 Page(1~13): Processing...
2025-11-21 17:32:55,170 INFO     23 __images__ 12 pages cost 7.906230339001922s
2025-11-21 17:32:55,217 INFO     23 set_progress(65dcc4b6c6c511f0a961e6dbbae0e740), progress: None, progress_msg: 17:32:55 Page(1~13): OCR finished (11.22s)
2025-11-21 17:33:19,529 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:33:19.527+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 2, "lag": 0, "done": 0, "failed": 0, "current": {"65dcc4b6c6c511f0a961e6dbbae0e740": {"id": "65dcc4b6c6c511f0a961e6dbbae0e740", "doc_id": "51767f30c6c511f0a961e6dbbae0e740", "from_page": 0, "to_page": 12, "retry_count": 0, "kb_id": "fb64ac5cc6c411f0a961e6dbbae0e740", "parser_id": "qa", "parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "name": "PO-RM-001-R04 Prosedur Manajemen Risiko.pdf", "type": "pdf", "location": "PO-RM-001-R04 Prosedur Manajemen Risiko.pdf", "size": 353499, "tenant_id": "0c0393e0c6c311f0ab43e60423e9a2b1", "language": "English", "embd_id": "text-embedding-004@Gemini", "pagerank": 0, "kb_parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "img2txt_id": "", "asr_id": "", "llm_id": "gemini-2.5-pro@Gemini", "update_time": 1763721156853, "task_type": ""}, "67977ac6c6c511f0a961e6dbbae0e740": {"id": "67977ac6c6c511f0a961e6dbbae0e740", "doc_id": "02403212c6c511f0a961e6dbbae0e740", "from_page": 0, "to_page": 12, "retry_count": 0, "kb_id": "fb64ac5cc6c411f0a961e6dbbae0e740", "parser_id": "qa", "parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "name": "PO-RM-001-R04 Prosedur Manajemen Risiko.pdf", "type": "pdf", "location": "PO-RM-001-R04 Prosedur Manajemen Risiko.pdf", "size": 353499, "tenant_id": "0c0393e0c6c311f0ab43e60423e9a2b1", "language": "English", "embd_id": "text-embedding-004@Gemini", "pagerank": 0, "kb_parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "img2txt_id": "", "asr_id": "", "llm_id": "gemini-2.5-pro@Gemini", "update_time": 1763721159768, "task_type": ""}}}
2025-11-21 17:33:22,694 INFO     23 set_progress(65dcc4b6c6c511f0a961e6dbbae0e740), progress: 0.63, progress_msg: 17:33:22 Page(1~13): Layout analysis (27.43s)
2025-11-21 17:33:24,188 INFO     23 set_progress(65dcc4b6c6c511f0a961e6dbbae0e740), progress: 0.65, progress_msg: 17:33:24 Page(1~13): Table analysis (1.43s)
2025-11-21 17:33:24,190 INFO     23 [Page 1] median_w=100.00, page_w=612.00, raw_cols=6, cand=6
2025-11-21 17:33:24,191 INFO     23 [Page 0] median_w=124.54, page_w=612.00, raw_cols=4, cand=4
2025-11-21 17:33:24,192 INFO     23 [Page 2] median_w=65.67, page_w=612.00, raw_cols=9, cand=9
2025-11-21 17:33:24,193 INFO     23 [Page 3] median_w=30.67, page_w=612.00, raw_cols=19, cand=19
2025-11-21 17:33:24,194 INFO     23 [Page 4] median_w=200.33, page_w=612.00, raw_cols=3, cand=3
2025-11-21 17:33:24,195 INFO     23 [Page 5] median_w=404.00, page_w=612.00, raw_cols=1, cand=1
2025-11-21 17:33:24,196 INFO     23 [Page 6] median_w=77.33, page_w=612.00, raw_cols=7, cand=7
2025-11-21 17:33:24,197 INFO     23 [Page 7] median_w=144.67, page_w=612.00, raw_cols=4, cand=4
2025-11-21 17:33:24,197 INFO     23 [Page 8] median_w=174.00, page_w=612.00, raw_cols=3, cand=3
2025-11-21 17:33:24,198 INFO     23 [Page 9] median_w=118.17, page_w=612.00, raw_cols=5, cand=5
2025-11-21 17:33:24,199 INFO     23 [Page 10] median_w=183.67, page_w=612.00, raw_cols=3, cand=3
2025-11-21 17:33:24,200 INFO     23 [Page 11] median_w=109.00, page_w=612.00, raw_cols=5, cand=5
2025-11-21 17:33:24,201 INFO     23 [Page 12] median_w=58.83, page_w=612.00, raw_cols=10, cand=10
2025-11-21 17:33:24,202 INFO     23 Global column_num decided by majority: 3
2025-11-21 17:33:24,279 INFO     23 set_progress(65dcc4b6c6c511f0a961e6dbbae0e740), progress: 0.67, progress_msg: 17:33:24 Page(1~13): Text merged (0.01s)
2025-11-21 17:33:24,512 INFO     23 Chunking(42.33016465500259) PO-RM-001-R04 Prosedur Manajemen Risiko.pdf/PO-RM-001-R04 Prosedur Manajemen Risiko.pdf done
2025-11-21 17:33:25,436 INFO     23 Close recognizer.
2025-11-21 17:33:25,440 INFO     23 Close recognizer.
2025-11-21 17:33:25,479 INFO     23 Close text detector.
2025-11-21 17:33:25,482 INFO     23 Close text recognizer.
2025-11-21 17:33:25,856 INFO     23 MINIO PUT(PO-RM-001-R04 Prosedur Manajemen Risiko.pdf) cost 1.342 s
2025-11-21 17:33:25,857 INFO     23 Build document PO-RM-001-R04 Prosedur Manajemen Risiko.pdf: 43.68s
2025-11-21 17:33:25,883 INFO     23 set_progress(67977ac6c6c511f0a961e6dbbae0e740), progress: 0.1, progress_msg: 17:33:25 Page(1~13): Start to parse.
2025-11-21 17:33:25,884 INFO     23 load_model /ragflow/rag/res/deepdoc/det.onnx reuses cached model
2025-11-21 17:33:25,891 INFO     23 load_model /ragflow/rag/res/deepdoc/rec.onnx reuses cached model
2025-11-21 17:33:25,892 INFO     23 load_model /ragflow/rag/res/deepdoc/layout.onnx reuses cached model
2025-11-21 17:33:25,893 INFO     23 load_model /ragflow/rag/res/deepdoc/tsr.onnx reuses cached model
2025-11-21 17:33:25,895 INFO     23 No torch found.
2025-11-21 17:33:25,901 INFO     23 set_progress(65dcc4b6c6c511f0a961e6dbbae0e740), progress: None, progress_msg: 17:33:25 Page(1~13): Generate 12 chunks
2025-11-21 17:33:25,942 INFO     23 set_progress(67977ac6c6c511f0a961e6dbbae0e740), progress: None, progress_msg: 17:33:25 Page(1~13): OCR started
2025-11-21 17:33:27,731 INFO     23 set_progress(65dcc4b6c6c511f0a961e6dbbae0e740), progress: 0.7166666666666667, progress_msg: 
2025-11-21 17:33:27,765 INFO     23 Embedding chunks (1.86s)
2025-11-21 17:33:27,918 INFO     23 set_progress(65dcc4b6c6c511f0a961e6dbbae0e740), progress: None, progress_msg: 17:33:27 Page(1~13): Embedding chunks (1.86s)
2025-11-21 17:33:28,160 INFO     23 PUT http://es01:9200/ragflow_0c0393e0c6c311f0ab43e60423e9a2b1/_bulk?refresh=false&timeout=60s [status:200 duration:0.206s]
2025-11-21 17:33:28,266 INFO     23 set_progress(65dcc4b6c6c511f0a961e6dbbae0e740), progress: 0.8083333333333333, progress_msg: 
2025-11-21 17:33:28,499 INFO     23 PUT http://es01:9200/ragflow_0c0393e0c6c311f0ab43e60423e9a2b1/_bulk?refresh=false&timeout=60s [status:200 duration:0.089s]
2025-11-21 17:33:28,797 INFO     23 PUT http://es01:9200/ragflow_0c0393e0c6c311f0ab43e60423e9a2b1/_bulk?refresh=false&timeout=60s [status:200 duration:0.226s]
2025-11-21 17:33:28,883 INFO     23 Indexing doc(PO-RM-001-R04 Prosedur Manajemen Risiko.pdf), page(0-12), chunks(12), elapsed: 0.94
2025-11-21 17:33:29,128 INFO     23 set_progress(65dcc4b6c6c511f0a961e6dbbae0e740), progress: None, progress_msg: 17:33:28 Page(1~13): Indexing done (1.02s).
2025-11-21 17:33:29,425 INFO     23 set_progress(65dcc4b6c6c511f0a961e6dbbae0e740), progress: 1.0, progress_msg: 17:33:29 Page(1~13): Task done (48.54s)
2025-11-21 17:33:29,457 INFO     23 Chunk doc(PO-RM-001-R04 Prosedur Manajemen Risiko.pdf), page(0-12), chunks(12), token(4017), elapsed:48.54
2025-11-21 17:33:29,479 INFO     23 handle_task done for task {"id": "65dcc4b6c6c511f0a961e6dbbae0e740", "doc_id": "51767f30c6c511f0a961e6dbbae0e740", "from_page": 0, "to_page": 12, "retry_count": 0, "kb_id": "fb64ac5cc6c411f0a961e6dbbae0e740", "parser_id": "qa", "parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "name": "PO-RM-001-R04 Prosedur Manajemen Risiko.pdf", "type": "pdf", "location": "PO-RM-001-R04 Prosedur Manajemen Risiko.pdf", "size": 353499, "tenant_id": "0c0393e0c6c311f0ab43e60423e9a2b1", "language": "English", "embd_id": "text-embedding-004@Gemini", "pagerank": 0, "kb_parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "img2txt_id": "", "asr_id": "", "llm_id": "gemini-2.5-pro@Gemini", "update_time": 1763721156853, "task_type": ""}
2025-11-21 17:33:29,504 INFO     23 __images__ dedupe_chars cost 3.561141377002059s
2025-11-21 17:33:29,541 WARNING  23 Miss outlines
2025-11-21 17:33:30,395 INFO     23 __ocr detecting boxes of a image cost (0.8469111510021321s)
2025-11-21 17:33:30,410 INFO     23 __ocr sorting 19 chars cost 0.0005821660015499219s
2025-11-21 17:33:33,070 INFO     23 __ocr recognize 12 boxes cost 2.6530844009976136s
2025-11-21 17:33:33,446 INFO     23 __ocr detecting boxes of a image cost (0.37060738800209947s)
2025-11-21 17:33:33,452 INFO     23 __ocr sorting 420 chars cost 0.004331789001298603s
2025-11-21 17:33:33,499 INFO     23 __ocr recognize 33 boxes cost 0.04601766500127269s
2025-11-21 17:33:33,920 INFO     23 __ocr detecting boxes of a image cost (0.4158934959996259s)
2025-11-21 17:33:33,936 INFO     23 __ocr sorting 1034 chars cost 0.01438888600023347s
2025-11-21 17:33:34,058 INFO     23 __ocr recognize 33 boxes cost 0.11832161500205984s
2025-11-21 17:33:34,516 INFO     23 __ocr detecting boxes of a image cost (0.4319148779977695s)
2025-11-21 17:33:34,543 INFO     23 __ocr sorting 2470 chars cost 0.02502484300202923s
2025-11-21 17:33:34,639 INFO     23 __ocr recognize 45 boxes cost 0.09563371200056281s
2025-11-21 17:33:34,995 INFO     23 __ocr detecting boxes of a image cost (0.34589921999941s)
2025-11-21 17:33:35,015 INFO     23 __ocr sorting 2503 chars cost 0.019032324002182577s
2025-11-21 17:33:35,043 INFO     23 __ocr recognize 47 boxes cost 0.02764380799999344s
2025-11-21 17:33:35,350 INFO     23 __ocr detecting boxes of a image cost (0.30190716899960535s)
2025-11-21 17:33:35,368 INFO     23 __ocr sorting 1646 chars cost 0.01701510299972142s
2025-11-21 17:33:35,481 INFO     23 __ocr recognize 51 boxes cost 0.11208626100051333s
2025-11-21 17:33:35,558 INFO     23 set_progress(67977ac6c6c511f0a961e6dbbae0e740), progress: 0.3, progress_msg: 17:33:35 Page(1~13): Processing...
2025-11-21 17:33:36,064 INFO     23 __ocr detecting boxes of a image cost (0.4971274960007577s)
2025-11-21 17:33:36,091 INFO     23 __ocr sorting 1857 chars cost 0.026065805002872366s
2025-11-21 17:33:36,147 INFO     23 __ocr recognize 47 boxes cost 0.0554034650012909s
2025-11-21 17:33:36,507 INFO     23 __ocr detecting boxes of a image cost (0.3522305040023639s)
2025-11-21 17:33:36,532 INFO     23 __ocr sorting 2338 chars cost 0.023803691001376137s
2025-11-21 17:33:36,571 INFO     23 __ocr recognize 57 boxes cost 0.03767354900264763s
2025-11-21 17:33:36,898 INFO     23 __ocr detecting boxes of a image cost (0.31983893399956287s)
2025-11-21 17:33:36,917 INFO     23 __ocr sorting 2107 chars cost 0.018455942001310177s
2025-11-21 17:33:36,954 INFO     23 __ocr recognize 59 boxes cost 0.03613805399800185s
2025-11-21 17:33:37,281 INFO     23 __ocr detecting boxes of a image cost (0.3201684240011673s)
2025-11-21 17:33:37,300 INFO     23 __ocr sorting 1907 chars cost 0.018065617001411738s
2025-11-21 17:33:37,368 INFO     23 __ocr recognize 48 boxes cost 0.06743611700221663s
2025-11-21 17:33:37,798 INFO     23 __ocr detecting boxes of a image cost (0.4219525219996285s)
2025-11-21 17:33:37,824 INFO     23 __ocr sorting 1957 chars cost 0.024177259001589846s
2025-11-21 17:33:37,900 INFO     23 __ocr recognize 55 boxes cost 0.07543548000103328s
2025-11-21 17:33:38,207 INFO     23 __ocr detecting boxes of a image cost (0.3031900959977065s)
2025-11-21 17:33:38,214 INFO     23 __ocr sorting 803 chars cost 0.005583426001976477s
2025-11-21 17:33:38,356 INFO     23 __ocr recognize 40 boxes cost 0.1411328069989395s
2025-11-21 17:33:38,403 INFO     23 set_progress(67977ac6c6c511f0a961e6dbbae0e740), progress: 0.6, progress_msg: 17:33:38 Page(1~13): Processing...
2025-11-21 17:33:38,404 INFO     23 __images__ 12 pages cost 8.860794733998773s
2025-11-21 17:33:38,435 INFO     23 set_progress(67977ac6c6c511f0a961e6dbbae0e740), progress: None, progress_msg: 17:33:38 Page(1~13): OCR finished (12.50s)
2025-11-21 17:33:49,537 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:33:49.535+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 1, "lag": 0, "done": 1, "failed": 0, "current": {"67977ac6c6c511f0a961e6dbbae0e740": {"id": "67977ac6c6c511f0a961e6dbbae0e740", "doc_id": "02403212c6c511f0a961e6dbbae0e740", "from_page": 0, "to_page": 12, "retry_count": 0, "kb_id": "fb64ac5cc6c411f0a961e6dbbae0e740", "parser_id": "qa", "parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "name": "PO-RM-001-R04 Prosedur Manajemen Risiko.pdf", "type": "pdf", "location": "PO-RM-001-R04 Prosedur Manajemen Risiko.pdf", "size": 353499, "tenant_id": "0c0393e0c6c311f0ab43e60423e9a2b1", "language": "English", "embd_id": "text-embedding-004@Gemini", "pagerank": 0, "kb_parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "img2txt_id": "", "asr_id": "", "llm_id": "gemini-2.5-pro@Gemini", "update_time": 1763721159768, "task_type": ""}}}
2025-11-21 17:34:06,414 INFO     23 set_progress(67977ac6c6c511f0a961e6dbbae0e740), progress: 0.63, progress_msg: 17:34:06 Page(1~13): Layout analysis (27.87s)
2025-11-21 17:34:07,559 INFO     23 set_progress(67977ac6c6c511f0a961e6dbbae0e740), progress: 0.65, progress_msg: 17:34:07 Page(1~13): Table analysis (1.09s)
2025-11-21 17:34:07,564 INFO     23 [Page 1] median_w=100.00, page_w=612.00, raw_cols=6, cand=6
2025-11-21 17:34:07,567 INFO     23 [Page 0] median_w=124.54, page_w=612.00, raw_cols=4, cand=4
2025-11-21 17:34:07,570 INFO     23 [Page 2] median_w=65.67, page_w=612.00, raw_cols=9, cand=9
2025-11-21 17:34:07,572 INFO     23 [Page 3] median_w=30.67, page_w=612.00, raw_cols=19, cand=19
2025-11-21 17:34:07,574 INFO     23 [Page 4] median_w=200.33, page_w=612.00, raw_cols=3, cand=3
2025-11-21 17:34:07,576 INFO     23 [Page 5] median_w=404.00, page_w=612.00, raw_cols=1, cand=1
2025-11-21 17:34:07,578 INFO     23 [Page 6] median_w=77.33, page_w=612.00, raw_cols=7, cand=7
2025-11-21 17:34:07,582 INFO     23 [Page 7] median_w=144.67, page_w=612.00, raw_cols=4, cand=4
2025-11-21 17:34:07,586 INFO     23 [Page 8] median_w=174.00, page_w=612.00, raw_cols=3, cand=3
2025-11-21 17:34:07,589 INFO     23 [Page 9] median_w=118.17, page_w=612.00, raw_cols=5, cand=5
2025-11-21 17:34:07,591 INFO     23 [Page 10] median_w=183.67, page_w=612.00, raw_cols=3, cand=3
2025-11-21 17:34:07,605 INFO     23 [Page 11] median_w=109.00, page_w=612.00, raw_cols=5, cand=5
2025-11-21 17:34:07,624 INFO     23 [Page 12] median_w=58.83, page_w=612.00, raw_cols=10, cand=10
2025-11-21 17:34:07,648 INFO     23 Global column_num decided by majority: 3
2025-11-21 17:34:07,738 INFO     23 set_progress(67977ac6c6c511f0a961e6dbbae0e740), progress: 0.67, progress_msg: 17:34:07 Page(1~13): Text merged (0.10s)
2025-11-21 17:34:08,188 INFO     23 Chunking(85.34968320200278) PO-RM-001-R04 Prosedur Manajemen Risiko.pdf/PO-RM-001-R04 Prosedur Manajemen Risiko.pdf done
2025-11-21 17:34:08,354 INFO     23 MINIO PUT(PO-RM-001-R04 Prosedur Manajemen Risiko.pdf) cost 0.165 s
2025-11-21 17:34:08,355 INFO     23 Build document PO-RM-001-R04 Prosedur Manajemen Risiko.pdf: 85.52s
2025-11-21 17:34:08,390 INFO     23 set_progress(67977ac6c6c511f0a961e6dbbae0e740), progress: None, progress_msg: 17:34:08 Page(1~13): Generate 12 chunks
2025-11-21 17:34:09,865 INFO     23 set_progress(67977ac6c6c511f0a961e6dbbae0e740), progress: 0.7166666666666667, progress_msg: 
2025-11-21 17:34:09,867 INFO     23 Embedding chunks (1.48s)
2025-11-21 17:34:09,919 INFO     23 set_progress(67977ac6c6c511f0a961e6dbbae0e740), progress: None, progress_msg: 17:34:09 Page(1~13): Embedding chunks (1.48s)
2025-11-21 17:34:10,003 INFO     23 PUT http://es01:9200/ragflow_0c0393e0c6c311f0ab43e60423e9a2b1/_bulk?refresh=false&timeout=60s [status:200 duration:0.077s]
2025-11-21 17:34:10,066 INFO     23 set_progress(67977ac6c6c511f0a961e6dbbae0e740), progress: 0.8083333333333333, progress_msg: 
2025-11-21 17:34:10,142 INFO     23 PUT http://es01:9200/ragflow_0c0393e0c6c311f0ab43e60423e9a2b1/_bulk?refresh=false&timeout=60s [status:200 duration:0.043s]
2025-11-21 17:34:10,221 INFO     23 PUT http://es01:9200/ragflow_0c0393e0c6c311f0ab43e60423e9a2b1/_bulk?refresh=false&timeout=60s [status:200 duration:0.037s]
2025-11-21 17:34:10,240 INFO     23 Indexing doc(PO-RM-001-R04 Prosedur Manajemen Risiko.pdf), page(0-12), chunks(12), elapsed: 0.32
2025-11-21 17:34:10,308 INFO     23 set_progress(67977ac6c6c511f0a961e6dbbae0e740), progress: None, progress_msg: 17:34:10 Page(1~13): Indexing done (0.35s).
2025-11-21 17:34:10,369 INFO     23 set_progress(67977ac6c6c511f0a961e6dbbae0e740), progress: 1.0, progress_msg: 17:34:10 Page(1~13): Task done (88.03s)
2025-11-21 17:34:10,370 INFO     23 Chunk doc(PO-RM-001-R04 Prosedur Manajemen Risiko.pdf), page(0-12), chunks(12), token(4017), elapsed:88.03
2025-11-21 17:34:10,371 INFO     23 handle_task done for task {"id": "67977ac6c6c511f0a961e6dbbae0e740", "doc_id": "02403212c6c511f0a961e6dbbae0e740", "from_page": 0, "to_page": 12, "retry_count": 0, "kb_id": "fb64ac5cc6c411f0a961e6dbbae0e740", "parser_id": "qa", "parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "name": "PO-RM-001-R04 Prosedur Manajemen Risiko.pdf", "type": "pdf", "location": "PO-RM-001-R04 Prosedur Manajemen Risiko.pdf", "size": 353499, "tenant_id": "0c0393e0c6c311f0ab43e60423e9a2b1", "language": "English", "embd_id": "text-embedding-004@Gemini", "pagerank": 0, "kb_parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "img2txt_id": "", "asr_id": "", "llm_id": "gemini-2.5-pro@Gemini", "update_time": 1763721159768, "task_type": ""}
2025-11-21 17:34:19,543 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:34:19.542+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:34:49,549 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:34:49.548+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:35:19,557 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:35:19.556+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:35:49,601 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:35:49.600+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:36:19,608 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:36:19.607+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:36:49,613 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:36:49.612+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:37:19,616 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:37:19.615+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:37:49,620 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:37:49.619+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:38:19,624 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:38:19.623+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:38:49,694 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:38:49.693+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:39:19,704 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:39:19.703+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:39:49,716 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:39:49.715+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:40:19,720 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:40:19.719+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:40:49,725 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:40:49.724+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:41:19,729 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:41:19.727+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:41:49,732 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:41:49.731+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:42:19,736 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:42:19.735+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:42:49,744 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:42:49.742+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:43:19,751 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:43:19.749+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:43:49,757 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:43:49.756+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:44:19,785 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:44:19.784+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:44:49,790 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:44:49.789+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:45:19,794 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:45:19.793+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:45:49,799 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:45:49.798+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 0, "current": {}}
2025-11-21 17:46:09,036 INFO     23 handle_task begin for task {"id": "49d73524c6c711f0a961e6dbbae0e740", "doc_id": "47ba33a4c6c711f0a961e6dbbae0e740", "from_page": 0, "to_page": 1, "retry_count": 0, "kb_id": "fb64ac5cc6c411f0a961e6dbbae0e740", "parser_id": "qa", "parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "name": "CISO_MindMap_2025.pdf", "type": "pdf", "location": "CISO_MindMap_2025.pdf", "size": 714322, "tenant_id": "0c0393e0c6c311f0ab43e60423e9a2b1", "language": "English", "embd_id": "text-embedding-004@Gemini", "pagerank": 0, "kb_parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "img2txt_id": "", "asr_id": "", "llm_id": "gemini-2.5-pro@Gemini", "update_time": 1763721968835, "task_type": ""}
2025-11-21 17:46:21,282 INFO     23 HEAD http://es01:9200/ragflow_0c0393e0c6c311f0ab43e60423e9a2b1 [status:200 duration:0.005s]
2025-11-21 17:46:21,297 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:46:21.291+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 1, "lag": 0, "done": 2, "failed": 0, "current": {"49d73524c6c711f0a961e6dbbae0e740": {"id": "49d73524c6c711f0a961e6dbbae0e740", "doc_id": "47ba33a4c6c711f0a961e6dbbae0e740", "from_page": 0, "to_page": 1, "retry_count": 0, "kb_id": "fb64ac5cc6c411f0a961e6dbbae0e740", "parser_id": "qa", "parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "name": "CISO_MindMap_2025.pdf", "type": "pdf", "location": "CISO_MindMap_2025.pdf", "size": 714322, "tenant_id": "0c0393e0c6c311f0ab43e60423e9a2b1", "language": "English", "embd_id": "text-embedding-004@Gemini", "pagerank": 0, "kb_parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "img2txt_id": "", "asr_id": "", "llm_id": "gemini-2.5-pro@Gemini", "update_time": 1763721968835, "task_type": ""}}}
2025-11-21 17:46:21,390 INFO     23 From minio(0.10638090100110276) CISO_MindMap_2025.pdf/CISO_MindMap_2025.pdf
2025-11-21 17:46:21,663 INFO     23 set_progress(49d73524c6c711f0a961e6dbbae0e740), progress: 0.1, progress_msg: 17:46:21 Page(1~2): Start to parse.
2025-11-21 17:46:21,665 INFO     23 load_model /ragflow/rag/res/deepdoc/det.onnx reuses cached model
2025-11-21 17:46:21,687 INFO     23 load_model /ragflow/rag/res/deepdoc/rec.onnx reuses cached model
2025-11-21 17:46:21,702 INFO     23 load_model /ragflow/rag/res/deepdoc/layout.onnx reuses cached model
2025-11-21 17:46:21,703 INFO     23 load_model /ragflow/rag/res/deepdoc/tsr.onnx reuses cached model
2025-11-21 17:46:21,715 INFO     23 No torch found.
2025-11-21 17:46:21,785 INFO     23 set_progress(49d73524c6c711f0a961e6dbbae0e740), progress: None, progress_msg: 17:46:21 Page(1~2): OCR started
2025-11-21 17:46:28,430 INFO     23 __images__ dedupe_chars cost 6.64460230399709s
2025-11-21 17:46:28,434 WARNING  23 Miss outlines
2025-11-21 17:46:29,048 INFO     23 __ocr detecting boxes of a image cost (0.6097655509984179s)
2025-11-21 17:46:29,050 INFO     23 __ocr sorting 0 chars cost 0.0004663500003516674s
2025-11-21 17:46:31,069 INFO     23 __ocr recognize 20 boxes cost 2.0176723639997363s
2025-11-21 17:46:31,072 INFO     23 __images__ 1 pages cost 2.6345510430001013s
2025-11-21 17:46:31,135 INFO     23 set_progress(49d73524c6c711f0a961e6dbbae0e740), progress: None, progress_msg: 17:46:31 Page(1~2): OCR finished (9.34s)
2025-11-21 17:46:33,424 INFO     23 set_progress(49d73524c6c711f0a961e6dbbae0e740), progress: 0.63, progress_msg: 17:46:33 Page(1~2): Layout analysis (2.25s)
2025-11-21 17:46:33,473 INFO     23 set_progress(49d73524c6c711f0a961e6dbbae0e740), progress: 0.65, progress_msg: 17:46:33 Page(1~2): Table analysis (0.00s)
2025-11-21 17:46:33,474 INFO     23 [Page 1] median_w=85.17, page_w=612.00, raw_cols=7, cand=7
2025-11-21 17:46:33,475 INFO     23 Global column_num decided by majority: 7
2025-11-21 17:46:33,522 INFO     23 set_progress(49d73524c6c711f0a961e6dbbae0e740), progress: 0.67, progress_msg: 17:46:33 Page(1~2): Text merged (0.00s)
2025-11-21 17:46:33,577 INFO     23 set_progress(49d73524c6c711f0a961e6dbbae0e740), progress: -1, progress_msg: 17:46:33 Page(1~2): [ERROR]Internal server error while chunking: Unable to recognize Q&A structure.
2025-11-21 17:46:33,579 ERROR    23 Chunking CISO_MindMap_2025.pdf/CISO_MindMap_2025.pdf got exception
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 254, in build_chunks
    cks = await trio.to_thread.run_sync(lambda: chunker.chunk(task["name"], binary=binary, from_page=task["from_page"],
  File "/ragflow/.venv/lib/python3.10/site-packages/trio/_threads.py", line 447, in to_thread_run_sync
    return msg_from_thread.unwrap()
  File "/ragflow/.venv/lib/python3.10/site-packages/outcome/_impl.py", line 213, in unwrap
    raise captured_error
  File "/ragflow/.venv/lib/python3.10/site-packages/trio/_threads.py", line 373, in do_release_then_return_result
    return result.unwrap()
  File "/ragflow/.venv/lib/python3.10/site-packages/outcome/_impl.py", line 213, in unwrap
    raise captured_error
  File "/ragflow/.venv/lib/python3.10/site-packages/trio/_threads.py", line 392, in worker_fn
    ret = context.run(sync_fn, *args)
  File "/ragflow/rag/svr/task_executor.py", line 254, in <lambda>
    cks = await trio.to_thread.run_sync(lambda: chunker.chunk(task["name"], binary=binary, from_page=task["from_page"],
  File "/ragflow/rag/app/qa.py", line 412, in chunk
    qai_list, tbls = pdf_parser(filename if not binary else binary,
  File "/ragflow/rag/app/qa.py", line 113, in __call__
    raise ValueError("Unable to recognize Q&A structure.")
ValueError: Unable to recognize Q&A structure.
2025-11-21 17:46:33,625 INFO     23 set_progress(49d73524c6c711f0a961e6dbbae0e740), progress: -1, progress_msg: 17:46:33 [ERROR][Exception]: Unable to recognize Q&A structure.
2025-11-21 17:46:33,628 ERROR    23 handle_task got exception for task {"id": "49d73524c6c711f0a961e6dbbae0e740", "doc_id": "47ba33a4c6c711f0a961e6dbbae0e740", "from_page": 0, "to_page": 1, "retry_count": 0, "kb_id": "fb64ac5cc6c411f0a961e6dbbae0e740", "parser_id": "qa", "parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "name": "CISO_MindMap_2025.pdf", "type": "pdf", "location": "CISO_MindMap_2025.pdf", "size": 714322, "tenant_id": "0c0393e0c6c311f0ab43e60423e9a2b1", "language": "English", "embd_id": "text-embedding-004@Gemini", "pagerank": 0, "kb_parser_config": {"raptor": {"use_raptor": false}, "graphrag": {"use_graphrag": false}}, "img2txt_id": "", "asr_id": "", "llm_id": "gemini-2.5-pro@Gemini", "update_time": 1763721968835, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 967, in handle_task
    await do_handle_task(task)
  File "/ragflow/common/connection_utils.py", line 76, in async_wrapper
    return await func(*args, **kwargs)
  File "/ragflow/rag/svr/task_executor.py", line 902, in do_handle_task
    chunks = await build_chunks(task, progress_callback)
  File "/ragflow/common/connection_utils.py", line 76, in async_wrapper
    return await func(*args, **kwargs)
  File "/ragflow/rag/svr/task_executor.py", line 254, in build_chunks
    cks = await trio.to_thread.run_sync(lambda: chunker.chunk(task["name"], binary=binary, from_page=task["from_page"],
  File "/ragflow/.venv/lib/python3.10/site-packages/trio/_threads.py", line 447, in to_thread_run_sync
    return msg_from_thread.unwrap()
  File "/ragflow/.venv/lib/python3.10/site-packages/outcome/_impl.py", line 213, in unwrap
    raise captured_error
  File "/ragflow/.venv/lib/python3.10/site-packages/trio/_threads.py", line 373, in do_release_then_return_result
    return result.unwrap()
  File "/ragflow/.venv/lib/python3.10/site-packages/outcome/_impl.py", line 213, in unwrap
    raise captured_error
  File "/ragflow/.venv/lib/python3.10/site-packages/trio/_threads.py", line 392, in worker_fn
    ret = context.run(sync_fn, *args)
  File "/ragflow/rag/svr/task_executor.py", line 254, in <lambda>
    cks = await trio.to_thread.run_sync(lambda: chunker.chunk(task["name"], binary=binary, from_page=task["from_page"],
  File "/ragflow/rag/app/qa.py", line 412, in chunk
    qai_list, tbls = pdf_parser(filename if not binary else binary,
  File "/ragflow/rag/app/qa.py", line 113, in __call__
    raise ValueError("Unable to recognize Q&A structure.")
ValueError: Unable to recognize Q&A structure.
2025-11-21 17:46:51,305 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:46:51.304+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 1, "current": {}}
2025-11-21 17:47:21,310 INFO     23 task_executor_07449693ba98_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 23, "name": "task_executor_07449693ba98_0", "now": "2025-11-21T17:47:21.308+07:00", "boot_at": "2025-11-21T17:27:49.350+07:00", "pending": 0, "lag": 0, "done": 2, "failed": 1, "current": {}}
2025-11-21 17:47:29,598 ERROR    23 RedisDB.queue_consumer rag_flow_svr_queue_1 got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 175, in collect
    redis_msg = next(UNACKED_ITERATOR)
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1116, in get_connection
    if connection.can_read() and connection.client_cache is None:
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 524, in can_read
    return self._parser.can_read(timeout)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/_parsers/base.py", line 128, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/_parsers/socket.py", line 95, in can_read
    return bool(self.unread_bytes()) or self._read_from_socket(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/_parsers/socket.py", line 68, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
valkey.exceptions.ConnectionError: Connection closed by server.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 261, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1120, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2025-11-21 17:47:29,605 ERROR    23 RedisDB.queue_consumer rag_flow_svr_queue_1 got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 175, in collect
    redis_msg = next(UNACKED_ITERATOR)
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 261, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2025-11-21 17:47:29,608 ERROR    23 RedisDB.queue_consumer rag_flow_svr_queue_1 got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 175, in collect
    redis_msg = next(UNACKED_ITERATOR)
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 261, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2025-11-21 17:47:29,612 ERROR    23 RedisDB.queue_consumer rag_flow_svr_queue got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 175, in collect
    redis_msg = next(UNACKED_ITERATOR)
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 261, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2025-11-21 17:47:29,614 ERROR    23 RedisDB.queue_consumer rag_flow_svr_queue got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 175, in collect
    redis_msg = next(UNACKED_ITERATOR)
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 261, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2025-11-21 17:47:29,617 ERROR    23 RedisDB.queue_consumer rag_flow_svr_queue got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 175, in collect
    redis_msg = next(UNACKED_ITERATOR)
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 261, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2025-11-21 17:47:29,697 ERROR    23 RedisDB.queue_consumer rag_flow_svr_queue_1 got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 175, in collect
    redis_msg = next(UNACKED_ITERATOR)
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 261, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2025-11-21 17:47:29,700 ERROR    23 RedisDB.queue_consumer rag_flow_svr_queue_1 got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 175, in collect
    redis_msg = next(UNACKED_ITERATOR)
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 261, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2025-11-21 17:47:29,704 ERROR    23 RedisDB.queue_consumer rag_flow_svr_queue_1 got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 175, in collect
    redis_msg = next(UNACKED_ITERATOR)
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 261, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2025-11-21 17:47:29,708 ERROR    23 RedisDB.queue_consumer rag_flow_svr_queue got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 175, in collect
    redis_msg = next(UNACKED_ITERATOR)
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 261, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2025-11-21 17:47:29,712 ERROR    23 RedisDB.queue_consumer rag_flow_svr_queue got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 175, in collect
    redis_msg = next(UNACKED_ITERATOR)
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 261, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2025-11-21 17:47:29,715 ERROR    23 RedisDB.queue_consumer rag_flow_svr_queue got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 175, in collect
    redis_msg = next(UNACKED_ITERATOR)
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 261, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2025-11-21 17:47:29,797 ERROR    23 RedisDB.queue_consumer rag_flow_svr_queue_1 got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 175, in collect
    redis_msg = next(UNACKED_ITERATOR)
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 261, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2025-11-21 17:47:29,800 ERROR    23 RedisDB.queue_consumer rag_flow_svr_queue_1 got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 175, in collect
    redis_msg = next(UNACKED_ITERATOR)
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 261, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2025-11-21 17:47:29,803 ERROR    23 RedisDB.queue_consumer rag_flow_svr_queue_1 got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 175, in collect
    redis_msg = next(UNACKED_ITERATOR)
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 261, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2025-11-21 17:47:29,805 ERROR    23 RedisDB.queue_consumer rag_flow_svr_queue got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 175, in collect
    redis_msg = next(UNACKED_ITERATOR)
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 261, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2025-11-21 17:47:29,808 ERROR    23 RedisDB.queue_consumer rag_flow_svr_queue got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 175, in collect
    redis_msg = next(UNACKED_ITERATOR)
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 261, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
2025-11-21 17:47:29,811 ERROR    23 RedisDB.queue_consumer rag_flow_svr_queue got exception: Error 111 connecting to redis:6379. Connection refused.
Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 175, in collect
    redis_msg = next(UNACKED_ITERATOR)
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 302, in connect
    sock = self.retry.call_with_retry(
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/retry.py", line 62, in call_with_retry
    return do()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 303, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 728, in _connect
    raise err
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 716, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/utils/redis_conn.py", line 261, in queue_consumer
    group_info = self.REDIS.xinfo_groups(queue_name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/commands/core.py", line 3810, in xinfo_groups
    return self.execute_command("XINFO GROUPS", name)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/client.py", line 564, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 1107, in get_connection
    connection.connect()
  File "/ragflow/.venv/lib/python3.10/site-packages/valkey/connection.py", line 308, in connect
    raise ConnectionError(self._error_message(e))
valkey.exceptions.ConnectionError: Error 111 connecting to redis:6379. Connection refused.
